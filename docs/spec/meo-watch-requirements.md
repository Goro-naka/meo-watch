# MEO Watch 要件定義書

## 概要

MEO Watch は、Googleマイビジネスの検索順位を自動監視し、競合分析も行える汎用的なSaaSツールです。手動での順位チェック作業（毎日3分 × 365日 = 18時間/年）を完全自動化し、複数キーワードでの順位変動を一元管理、競合他社との比較分析を可能にします。

## ユーザストーリー

### ストーリー1: 順位監視の自動化

- **である** 店舗オーナー **として**
- **私は** 複数のキーワードで自動的に検索順位を監視 **したい**
- **そうすることで** 毎日の手動チェック作業（年間18時間）を削減し、本業に集中できる

### ストーリー2: 競合分析とベンチマーク

- **である** マーケティング担当者 **として**
- **私は** 同一検索結果に表示される競合他社の順位変動と口コミ数・評価スコアを把握 **したい**
- **そうすることで** データに基づいた競合優位性の戦略を立案できる

### ストーリー3: データ主導の順位管理

- **である** 忙しい経営者 **として**
- **私は** ダッシュボードで順位変動を定期的に確認し、重要な変化を把握 **したい**
- **そうすることで** データに基づいた迅速な対応により機会損失を最小限に抑えられる

### ストーリー4: データ分析とレポート

- **である** データ分析担当者 **として**
- **私は** 過去の順位データをCSV形式でエクスポートし独自の分析 **をしたい**
- **そうすることで** 詳細なトレンド分析とカスタムレポート作成が可能になる

## 機能要件（EARS記法）

### 通常要件（SHALL）

- REQ-001: システムはユーザーが登録したキーワード（最大50個）で毎日決まった時間に自動的にGoogle Maps検索を実行しなければならない
- REQ-002: システムは検索結果から対象店舗の順位を自動取得し、データベースに保存しなければならない
- REQ-003: システムは同一検索結果に表示される競合店舗の情報（店名、順位、評価、口コミ数）を自動取得しなければならない
- REQ-004: システムはダッシュボードで順位の推移をグラフ形式で表示しなければならない
- REQ-005: システムはSupabase Authを使用したユーザー認証機能を提供しなければならない
- REQ-006: システムはStripeを使用した決済処理機能を提供しなければならない
- REQ-007: システムは料金プラン別のキーワード数制限を管理しなければならない

### 条件付き要件（WHEN/IF-THEN）

- REQ-101: ユーザーがBusiness以上のプランの場合、システムは競合分析機能を提供しなければならない
- REQ-102: ユーザーがBusiness以上のプランの場合、システムはCSVエクスポート機能を提供しなければならない
- REQ-103: Google Maps API利用制限に達した場合、システムは監視を一時停止し管理者に通知しなければならない
- REQ-104: 決済処理が失敗した場合、システムは3回まで自動リトライし、失敗時はユーザーに通知しなければならない

### 状態要件（WHERE）

- REQ-201: ユーザーがログイン状態にある場合、システムはダッシュボードへのアクセスを許可しなければならない
- REQ-202: ユーザーが未認証状態にある場合、システムはログインページにリダイレクトしなければならない
- REQ-203: ユーザーが有料プランの場合、システムはプラン別の全機能へのアクセスを許可しなければならない

### オプション要件（MAY）

- REQ-301: システムはAPI連携機能を提供してもよい（Professional プラン）
- REQ-302: システムはモバイル最適化されたレスポンシブデザインを提供してもよい
- REQ-303: システムはマルチユーザー対応機能を提供してもよい

### 制約要件（MUST）

- REQ-401: システムは個人情報保護法に準拠して個人データを管理しなければならない
- REQ-402: システムはGoogle Maps API利用規約を遵守しなければならない
- REQ-403: システムは不正アクセスを防ぐため適切なHTTPS通信と認証・認可機能を実装しなければならない
- REQ-404: システムはクレジットカード情報をPCI DSS基準に従い処理しなければならない

## 非機能要件

### パフォーマンス

- NFR-001: システムは1日あたり最大10,000キーワードの順位チェックを処理できること
- NFR-002: ダッシュボードのページ読み込み時間は3秒以内であること
- NFR-003: Next.js API Routesの応答時間は平均2秒以内であること
- NFR-004: 同時接続ユーザー数500人まで対応できること

### セキュリティ

- NFR-101: 全ての通信はHTTPS で暗号化されること
- NFR-102: Supabase Authによる認証とJWTトークン管理を使用すること
- NFR-103: APIアクセスはレート制限（100リクエスト/分）を設けること
- NFR-104: 機密データは暗号化してSupabaseに保存されること

### ユーザビリティ

- NFR-201: Tailwind CSSを使用したレスポンシブデザインでモバイル端末に対応すること
- NFR-202: 主要な操作は3クリック以内で完了できること
- NFR-203: エラーメッセージは分かりやすい日本語で表示されること
- NFR-204: 初回ユーザーでも10分以内に基本設定を完了できること

### 可用性

- NFR-301: Vercelでのデプロイによりシステム稼働率99.9%以上を維持すること
- NFR-302: 計画メンテナンス以外のダウンタイムは月間4時間以内であること
- NFR-303: Supabaseによるデータベースの自動バックアップを利用すること

## Edgeケース

### エラー処理

- EDGE-001: Google Maps API制限達成時は、翌日の監視再開まで待機し、ユーザーに通知する
- EDGE-002: 対象店舗が検索結果に表示されない場合は、「圏外」として記録する
- EDGE-003: Stripe決済処理エラー時は、ユーザーに詳細なエラーメッセージを表示し、サポートへの連絡方法を案内する
- EDGE-004: Supabaseデータベース接続エラー時は、フェイルセーフモードで基本機能のみ提供する

### 境界値

- EDGE-101: プラン別キーワード登録上限（Starter: 3個、Business: 10個、Professional: 50個）に達した場合は、追加登録を制限しプラン変更を促す
- EDGE-102: 検索結果が20位圏外の場合は、「20位圏外」として表示する
- EDGE-103: 過去データが1年を超える場合は、古いデータをアーカイブする

### データ整合性

- EDGE-201: 重複する順位データが検出された場合は、最新のデータを保持し、古いデータを削除する
- EDGE-202: 不正な順位データ（負の値など）が検出された場合は、エラーログを記録し、データを無効化する
- EDGE-203: 競合店舗データの不整合が検出された場合は、再取得を実行する

## 受け入れ基準

### 機能テスト

- [ ] ユーザーは新規アカウント作成ができる（Supabase Auth使用）
- [ ] ユーザーはキーワードを登録・編集・削除できる
- [ ] システムは登録されたキーワードで日次検索を自動実行する
- [ ] ダッシュボードで順位推移グラフが表示される
- [ ] 順位変動時にメール通知が送信される
- [ ] 料金プラン別の機能制限が正常に動作する（Starter: 3個、Business: 10個、Professional: 50個）
- [ ] 競合分析データが正確に表示される（Business以上）
- [ ] CSVエクスポート機能が動作する（Business以上）
- [ ] Stripe決済処理が正常に完了する

### 非機能テスト

- [ ] Next.jsでのページ読み込み時間が3秒以内である
- [ ] 500同時ユーザーでのパフォーマンステストをパスする
- [ ] セキュリティ脆弱性スキャンをパスする
- [ ] Tailwind CSSによるモバイル端末でのレスポンシブ表示が適切である
- [ ] 負荷テスト（10,000キーワード/日）をパスする

### 統合テスト

- [ ] Google Maps API連携が正常に動作する
- [ ] Supabase認証・データベース連携が正常に動作する
- [ ] Stripe決済連携が正常に動作する
- [ ] メール送信機能が正常に動作する
- [ ] Vercelでのデプロイが正常に完了する

## 開発フェーズ別要件

### Phase 1: MVP (Week 1-6)
- データベース設計（Supabase PostgreSQL）
- キーワード管理機能
- Google Maps API連携
- 基本的な順位取得機能
- シンプルなダッシュボード

### Phase 2: Core Features (Week 7-10)
- 競合分析機能
- データエクスポート機能
- アラート通知システム
- 料金プラン・決済機能（Stripe連携）

### Phase 3: Advanced Features (Week 11-14)
- API連携機能
- 高度なレポート機能
- マルチユーザー対応
- モバイル最適化

---

**ファイル作成日**: 2025-09-26
**バージョン**: 2.0
**技術スタック**: Next.js 15, React 19, TypeScript, Supabase, Tailwind CSS, Stripe, Vercel
**作成者**: MEO Watch開発チーム